2025-05-22T12:58:35.008+05:30  INFO 97469 --- [main] o.s.a.m.s.server.McpServerApplication    : Starting McpServerApplication using Java 17.0.13.0.101 with PID 97469 (/Users/akshay.kumar2/workspace/mcp/spring-ai-examples/model-context-protocol/weather/starter-webmvc-oauth2-server/target/classes started by akshay.kumar2 in /Users/akshay.kumar2/workspace/mcp/spring-ai-examples/model-context-protocol/weather/starter-webmvc-oauth2-server)
2025-05-22T12:58:35.010+05:30  INFO 97469 --- [main] o.s.a.m.s.server.McpServerApplication    : No active profile set, falling back to 1 default profile: "default"
2025-05-22T12:58:35.342+05:30  INFO 97469 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2025-05-22T12:58:35.347+05:30  INFO 97469 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-05-22T12:58:35.347+05:30  INFO 97469 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-22T12:58:35.366+05:30  INFO 97469 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-05-22T12:58:35.366+05:30  INFO 97469 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 343 ms
2025-05-22T12:58:35.469+05:30 TRACE 97469 --- [main] eGlobalAuthenticationAutowiredConfigurer : Eagerly initializing {securityConfiguration=org.springframework.ai.mcp.sample.server.SecurityConfiguration$$SpringCGLIB$$0@11f9535b}
2025-05-22T12:58:35.470+05:30 DEBUG 97469 --- [main] swordEncoderAuthenticationManagerBuilder : No authenticationProviders and no parentAuthenticationManager defined. Returning null.
2025-05-22T12:58:36.534+05:30 DEBUG 97469 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, AuthorizationServerContextFilter, HeaderWriterFilter, CorsFilter, CsrfFilter, LogoutFilter, OAuth2AuthorizationServerMetadataEndpointFilter, OAuth2AuthorizationEndpointFilter, OAuth2DeviceVerificationEndpointFilter, NimbusJwkSetEndpointFilter, OAuth2ClientAuthenticationFilter, BearerTokenAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter, OAuth2TokenEndpointFilter, OAuth2TokenIntrospectionEndpointFilter, OAuth2TokenRevocationEndpointFilter, OAuth2DeviceAuthorizationEndpointFilter
2025-05-22T12:58:36.545+05:30 DEBUG 97469 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.OAuth2AuthorizationServerConfigurer$$Lambda$995/0x000000c8014b1d48@6097fca9 with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, AuthorizationServerContextFilter, HeaderWriterFilter, CsrfFilter, OidcLogoutEndpointFilter, LogoutFilter, OAuth2AuthorizationServerMetadataEndpointFilter, OAuth2AuthorizationEndpointFilter, OAuth2DeviceVerificationEndpointFilter, OidcProviderConfigurationEndpointFilter, NimbusJwkSetEndpointFilter, OAuth2ClientAuthenticationFilter, BearerTokenAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, ExceptionTranslationFilter, AuthorizationFilter, OAuth2TokenEndpointFilter, OAuth2TokenIntrospectionEndpointFilter, OAuth2TokenRevocationEndpointFilter, OAuth2DeviceAuthorizationEndpointFilter, OidcUserInfoEndpointFilter, OidcClientRegistrationEndpointFilter
2025-05-22T12:58:36.671+05:30  INFO 97469 --- [main] o.s.a.m.s.a.McpServerAutoConfiguration   : Enable tools capabilities, notification: true
2025-05-22T12:58:36.673+05:30  INFO 97469 --- [main] o.s.a.m.s.a.McpServerAutoConfiguration   : Registered tools: 3
2025-05-22T12:58:36.673+05:30  INFO 97469 --- [main] o.s.a.m.s.a.McpServerAutoConfiguration   : Enable resources capabilities, notification: true
2025-05-22T12:58:36.673+05:30  INFO 97469 --- [main] o.s.a.m.s.a.McpServerAutoConfiguration   : Enable prompts capabilities, notification: true
2025-05-22T12:58:36.674+05:30  INFO 97469 --- [main] o.s.a.m.s.a.McpServerAutoConfiguration   : Enable completions capabilities
2025-05-22T12:58:36.697+05:30  INFO 97469 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2025-05-22T12:58:36.701+05:30  INFO 97469 --- [main] o.s.a.m.s.server.McpServerApplication    : Started McpServerApplication in 1.85 seconds (process running for 1.957)
2025-05-22T12:59:26.323+05:30  INFO 97469 --- [http-nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-22T12:59:26.323+05:30  INFO 97469 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-05-22T12:59:26.324+05:30  INFO 97469 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2025-05-22T12:59:26.334+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'authorizationServerSecurityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.OAuth2AuthorizationServerConfigurer$$Lambda$995/0x000000c8014b1d48@6097fca9] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Csrf, OidcLogoutEndpoint, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, OidcProviderConfigurationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint, OidcUserInfoEndpoint, OidcClientRegistrationEndpoint] (1/2)
2025-05-22T12:59:26.334+05:30 DEBUG 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing POST /oauth2/token
2025-05-22T12:59:26.335+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/26)
2025-05-22T12:59:26.335+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/26)
2025-05-22T12:59:26.336+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/26)
2025-05-22T12:59:26.336+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking AuthorizationServerContextFilter (4/26)
2025-05-22T12:59:26.337+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (5/26)
2025-05-22T12:59:26.338+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking CsrfFilter (6/26)
2025-05-22T12:59:26.339+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.csrf.CsrfFilter         : Did not protect against CSRF since request did not match And [CsrfNotRequired [TRACE, HEAD, GET, OPTIONS], Not [Or [Or [Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]], Ant [pattern='/.well-known/oauth-authorization-server', GET], Or [Ant [pattern='/oauth2/authorize', GET], Ant [pattern='/oauth2/authorize', POST]], Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST], Or [Ant [pattern='/oauth2/device_verification', GET], Ant [pattern='/oauth2/device_verification', POST]], Or [Ant [pattern='/.well-known/openid-configuration', GET], Or [Ant [pattern='/connect/logout', GET], Ant [pattern='/connect/logout', POST]], Or [Ant [pattern='/userinfo', GET], Ant [pattern='/userinfo', POST]], Or [Ant [pattern='/connect/register', POST], Ant [pattern='/connect/register', GET]]], Ant [pattern='/oauth2/jwks', GET]], org.springframework.security.config.annotation.web.configurers.oauth2.server.resource.OAuth2ResourceServerConfigurer$BearerTokenRequestMatcher@3c19592c]]]
2025-05-22T12:59:26.339+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking OidcLogoutEndpointFilter (7/26)
2025-05-22T12:59:26.339+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (8/26)
2025-05-22T12:59:26.339+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Ant [pattern='/logout', POST]
2025-05-22T12:59:26.339+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationServerMetadataEndpointFilter (9/26)
2025-05-22T12:59:26.339+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationEndpointFilter (10/26)
2025-05-22T12:59:26.339+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceVerificationEndpointFilter (11/26)
2025-05-22T12:59:26.340+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking OidcProviderConfigurationEndpointFilter (12/26)
2025-05-22T12:59:26.340+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking NimbusJwkSetEndpointFilter (13/26)
2025-05-22T12:59:26.340+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking OAuth2ClientAuthenticationFilter (14/26)
2025-05-22T12:59:26.341+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking BearerTokenAuthenticationFilter (15/26)
2025-05-22T12:59:26.341+05:30 TRACE 97469 --- [http-nio-8080-exec-1] .s.r.w.a.BearerTokenAuthenticationFilter : Did not process request since did not find bearer token
2025-05-22T12:59:26.341+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking RequestCacheAwareFilter (16/26)
2025-05-22T12:59:26.341+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.s.w.s.HttpSessionRequestCache        : matchingRequestParameterName is required for getMatchingRequest to lookup a value, but not provided
2025-05-22T12:59:26.341+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderAwareRequestFilter (17/26)
2025-05-22T12:59:26.342+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking AnonymousAuthenticationFilter (18/26)
2025-05-22T12:59:26.342+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking ExceptionTranslationFilter (19/26)
2025-05-22T12:59:26.342+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking AuthorizationFilter (20/26)
2025-05-22T12:59:26.342+05:30 TRACE 97469 --- [http-nio-8080-exec-1] estMatcherDelegatingAuthorizationManager : Authorizing POST /oauth2/token
2025-05-22T12:59:26.342+05:30 TRACE 97469 --- [http-nio-8080-exec-1] estMatcherDelegatingAuthorizationManager : Checking authorization on POST /oauth2/token using org.springframework.security.authorization.AuthenticatedAuthorizationManager@2ee4386c
2025-05-22T12:59:26.342+05:30 TRACE 97469 --- [http-nio-8080-exec-1] w.c.HttpSessionSecurityContextRepository : No HttpSession currently exists
2025-05-22T12:59:26.342+05:30 TRACE 97469 --- [http-nio-8080-exec-1] .s.s.w.c.SupplierDeferredSecurityContext : Created SecurityContextImpl [Null authentication]
2025-05-22T12:59:26.342+05:30 TRACE 97469 --- [http-nio-8080-exec-1] .s.s.w.c.SupplierDeferredSecurityContext : Created SecurityContextImpl [Null authentication]
2025-05-22T12:59:26.343+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to AnonymousAuthenticationToken [Principal=anonymousUser, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ANONYMOUS]]
2025-05-22T12:59:26.343+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.s.w.a.ExceptionTranslationFilter     : Sending AnonymousAuthenticationToken [Principal=anonymousUser, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ANONYMOUS]] to authentication entry point since access is denied

org.springframework.security.authorization.AuthorizationDeniedException: Access Denied
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:99) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.resource.web.authentication.BearerTokenAuthenticationFilter.doFilterInternal(BearerTokenAuthenticationFilter.java:128) ~[spring-security-oauth2-resource-server-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2ClientAuthenticationFilter.doFilterInternal(OAuth2ClientAuthenticationFilter.java:144) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.NimbusJwkSetEndpointFilter.doFilterInternal(NimbusJwkSetEndpointFilter.java:88) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.oidc.web.OidcProviderConfigurationEndpointFilter.doFilterInternal(OidcProviderConfigurationEndpointFilter.java:91) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2DeviceVerificationEndpointFilter.doFilterInternal(OAuth2DeviceVerificationEndpointFilter.java:152) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2AuthorizationEndpointFilter.doFilterInternal(OAuth2AuthorizationEndpointFilter.java:175) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2AuthorizationServerMetadataEndpointFilter.doFilterInternal(OAuth2AuthorizationServerMetadataEndpointFilter.java:90) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.oidc.web.OidcLogoutEndpointFilter.doFilterInternal(OidcLogoutEndpointFilter.java:105) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.csrf.CsrfFilter.doFilterInternal(CsrfFilter.java:117) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.AuthorizationServerContextFilter.doFilterInternal(AuthorizationServerContextFilter.java:69) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243) ~[spring-webmvc-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238) ~[spring-security-config-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

2025-05-22T12:59:26.347+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.s.w.s.HttpSessionRequestCache        : Did not save request since it did not match [And [Ant [pattern='/**', GET], Not [Ant [pattern='/**/favicon.*']], Not [MediaTypeRequestMatcher [contentNegotiationStrategy=org.springframework.web.accept.ContentNegotiationManager@75c6396f, matchingMediaTypes=[application/json], useEquals=false, ignoredMediaTypes=[*/*]]], Not [RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]], Not [MediaTypeRequestMatcher [contentNegotiationStrategy=org.springframework.web.accept.ContentNegotiationManager@75c6396f, matchingMediaTypes=[multipart/form-data], useEquals=false, ignoredMediaTypes=[*/*]]], Not [MediaTypeRequestMatcher [contentNegotiationStrategy=org.springframework.web.accept.ContentNegotiationManager@75c6396f, matchingMediaTypes=[text/event-stream], useEquals=false, ignoredMediaTypes=[*/*]]]]]
2025-05-22T12:59:26.347+05:30 DEBUG 97469 --- [http-nio-8080-exec-1] s.w.a.DelegatingAuthenticationEntryPoint : Trying to match using Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]]
2025-05-22T12:59:26.347+05:30 DEBUG 97469 --- [http-nio-8080-exec-1] s.w.a.DelegatingAuthenticationEntryPoint : Match found! Executing org.springframework.security.web.authentication.HttpStatusEntryPoint@26e56178
2025-05-22T12:59:26.348+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]
2025-05-22T13:00:14.874+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'authorizationServerSecurityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.OAuth2AuthorizationServerConfigurer$$Lambda$995/0x000000c8014b1d48@6097fca9] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Csrf, OidcLogoutEndpoint, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, OidcProviderConfigurationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint, OidcUserInfoEndpoint, OidcClientRegistrationEndpoint] (1/2)
2025-05-22T13:00:14.874+05:30 DEBUG 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Securing POST /oauth2/token
2025-05-22T13:00:14.874+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/26)
2025-05-22T13:00:14.875+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/26)
2025-05-22T13:00:14.875+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/26)
2025-05-22T13:00:14.875+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking AuthorizationServerContextFilter (4/26)
2025-05-22T13:00:14.875+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (5/26)
2025-05-22T13:00:14.875+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking CsrfFilter (6/26)
2025-05-22T13:00:14.875+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.csrf.CsrfFilter         : Did not protect against CSRF since request did not match And [CsrfNotRequired [TRACE, HEAD, GET, OPTIONS], Not [Or [Or [Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]], Ant [pattern='/.well-known/oauth-authorization-server', GET], Or [Ant [pattern='/oauth2/authorize', GET], Ant [pattern='/oauth2/authorize', POST]], Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST], Or [Ant [pattern='/oauth2/device_verification', GET], Ant [pattern='/oauth2/device_verification', POST]], Or [Ant [pattern='/.well-known/openid-configuration', GET], Or [Ant [pattern='/connect/logout', GET], Ant [pattern='/connect/logout', POST]], Or [Ant [pattern='/userinfo', GET], Ant [pattern='/userinfo', POST]], Or [Ant [pattern='/connect/register', POST], Ant [pattern='/connect/register', GET]]], Ant [pattern='/oauth2/jwks', GET]], org.springframework.security.config.annotation.web.configurers.oauth2.server.resource.OAuth2ResourceServerConfigurer$BearerTokenRequestMatcher@3c19592c]]]
2025-05-22T13:00:14.875+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking OidcLogoutEndpointFilter (7/26)
2025-05-22T13:00:14.875+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (8/26)
2025-05-22T13:00:14.875+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Ant [pattern='/logout', POST]
2025-05-22T13:00:14.876+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationServerMetadataEndpointFilter (9/26)
2025-05-22T13:00:14.876+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationEndpointFilter (10/26)
2025-05-22T13:00:14.876+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceVerificationEndpointFilter (11/26)
2025-05-22T13:00:14.876+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking OidcProviderConfigurationEndpointFilter (12/26)
2025-05-22T13:00:14.876+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking NimbusJwkSetEndpointFilter (13/26)
2025-05-22T13:00:14.876+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking OAuth2ClientAuthenticationFilter (14/26)
2025-05-22T13:00:14.876+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking BearerTokenAuthenticationFilter (15/26)
2025-05-22T13:00:14.876+05:30 TRACE 97469 --- [http-nio-8080-exec-2] .s.r.w.a.BearerTokenAuthenticationFilter : Did not process request since did not find bearer token
2025-05-22T13:00:14.876+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking RequestCacheAwareFilter (16/26)
2025-05-22T13:00:14.876+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.s.w.s.HttpSessionRequestCache        : matchingRequestParameterName is required for getMatchingRequest to lookup a value, but not provided
2025-05-22T13:00:14.876+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderAwareRequestFilter (17/26)
2025-05-22T13:00:14.876+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking AnonymousAuthenticationFilter (18/26)
2025-05-22T13:00:14.876+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking ExceptionTranslationFilter (19/26)
2025-05-22T13:00:14.877+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.security.web.FilterChainProxy        : Invoking AuthorizationFilter (20/26)
2025-05-22T13:00:14.877+05:30 TRACE 97469 --- [http-nio-8080-exec-2] estMatcherDelegatingAuthorizationManager : Authorizing POST /oauth2/token
2025-05-22T13:00:14.877+05:30 TRACE 97469 --- [http-nio-8080-exec-2] estMatcherDelegatingAuthorizationManager : Checking authorization on POST /oauth2/token using org.springframework.security.authorization.AuthenticatedAuthorizationManager@2ee4386c
2025-05-22T13:00:14.877+05:30 TRACE 97469 --- [http-nio-8080-exec-2] w.c.HttpSessionSecurityContextRepository : No HttpSession currently exists
2025-05-22T13:00:14.877+05:30 TRACE 97469 --- [http-nio-8080-exec-2] .s.s.w.c.SupplierDeferredSecurityContext : Created SecurityContextImpl [Null authentication]
2025-05-22T13:00:14.877+05:30 TRACE 97469 --- [http-nio-8080-exec-2] .s.s.w.c.SupplierDeferredSecurityContext : Created SecurityContextImpl [Null authentication]
2025-05-22T13:00:14.877+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to AnonymousAuthenticationToken [Principal=anonymousUser, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ANONYMOUS]]
2025-05-22T13:00:14.877+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.s.w.a.ExceptionTranslationFilter     : Sending AnonymousAuthenticationToken [Principal=anonymousUser, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ANONYMOUS]] to authentication entry point since access is denied

org.springframework.security.authorization.AuthorizationDeniedException: Access Denied
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:99) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.resource.web.authentication.BearerTokenAuthenticationFilter.doFilterInternal(BearerTokenAuthenticationFilter.java:128) ~[spring-security-oauth2-resource-server-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2ClientAuthenticationFilter.doFilterInternal(OAuth2ClientAuthenticationFilter.java:144) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.NimbusJwkSetEndpointFilter.doFilterInternal(NimbusJwkSetEndpointFilter.java:88) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.oidc.web.OidcProviderConfigurationEndpointFilter.doFilterInternal(OidcProviderConfigurationEndpointFilter.java:91) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2DeviceVerificationEndpointFilter.doFilterInternal(OAuth2DeviceVerificationEndpointFilter.java:152) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2AuthorizationEndpointFilter.doFilterInternal(OAuth2AuthorizationEndpointFilter.java:175) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2AuthorizationServerMetadataEndpointFilter.doFilterInternal(OAuth2AuthorizationServerMetadataEndpointFilter.java:90) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.oidc.web.OidcLogoutEndpointFilter.doFilterInternal(OidcLogoutEndpointFilter.java:105) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.csrf.CsrfFilter.doFilterInternal(CsrfFilter.java:117) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.AuthorizationServerContextFilter.doFilterInternal(AuthorizationServerContextFilter.java:69) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243) ~[spring-webmvc-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238) ~[spring-security-config-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

2025-05-22T13:00:14.878+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.s.w.s.HttpSessionRequestCache        : Did not save request since it did not match [And [Ant [pattern='/**', GET], Not [Ant [pattern='/**/favicon.*']], Not [MediaTypeRequestMatcher [contentNegotiationStrategy=org.springframework.web.accept.ContentNegotiationManager@75c6396f, matchingMediaTypes=[application/json], useEquals=false, ignoredMediaTypes=[*/*]]], Not [RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]], Not [MediaTypeRequestMatcher [contentNegotiationStrategy=org.springframework.web.accept.ContentNegotiationManager@75c6396f, matchingMediaTypes=[multipart/form-data], useEquals=false, ignoredMediaTypes=[*/*]]], Not [MediaTypeRequestMatcher [contentNegotiationStrategy=org.springframework.web.accept.ContentNegotiationManager@75c6396f, matchingMediaTypes=[text/event-stream], useEquals=false, ignoredMediaTypes=[*/*]]]]]
2025-05-22T13:00:14.878+05:30 DEBUG 97469 --- [http-nio-8080-exec-2] s.w.a.DelegatingAuthenticationEntryPoint : Trying to match using Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]]
2025-05-22T13:00:14.878+05:30 DEBUG 97469 --- [http-nio-8080-exec-2] s.w.a.DelegatingAuthenticationEntryPoint : Match found! Executing org.springframework.security.web.authentication.HttpStatusEntryPoint@26e56178
2025-05-22T13:00:14.878+05:30 TRACE 97469 --- [http-nio-8080-exec-2] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]
2025-05-22T13:00:52.188+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'authorizationServerSecurityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.OAuth2AuthorizationServerConfigurer$$Lambda$995/0x000000c8014b1d48@6097fca9] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Csrf, OidcLogoutEndpoint, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, OidcProviderConfigurationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint, OidcUserInfoEndpoint, OidcClientRegistrationEndpoint] (1/2)
2025-05-22T13:00:52.188+05:30 DEBUG 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Securing POST /oauth2/token
2025-05-22T13:00:52.189+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/26)
2025-05-22T13:00:52.189+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/26)
2025-05-22T13:00:52.189+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/26)
2025-05-22T13:00:52.189+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking AuthorizationServerContextFilter (4/26)
2025-05-22T13:00:52.189+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (5/26)
2025-05-22T13:00:52.190+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking CsrfFilter (6/26)
2025-05-22T13:00:52.190+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.csrf.CsrfFilter         : Did not protect against CSRF since request did not match And [CsrfNotRequired [TRACE, HEAD, GET, OPTIONS], Not [Or [Or [Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]], Ant [pattern='/.well-known/oauth-authorization-server', GET], Or [Ant [pattern='/oauth2/authorize', GET], Ant [pattern='/oauth2/authorize', POST]], Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST], Or [Ant [pattern='/oauth2/device_verification', GET], Ant [pattern='/oauth2/device_verification', POST]], Or [Ant [pattern='/.well-known/openid-configuration', GET], Or [Ant [pattern='/connect/logout', GET], Ant [pattern='/connect/logout', POST]], Or [Ant [pattern='/userinfo', GET], Ant [pattern='/userinfo', POST]], Or [Ant [pattern='/connect/register', POST], Ant [pattern='/connect/register', GET]]], Ant [pattern='/oauth2/jwks', GET]], org.springframework.security.config.annotation.web.configurers.oauth2.server.resource.OAuth2ResourceServerConfigurer$BearerTokenRequestMatcher@3c19592c]]]
2025-05-22T13:00:52.190+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking OidcLogoutEndpointFilter (7/26)
2025-05-22T13:00:52.190+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (8/26)
2025-05-22T13:00:52.190+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Ant [pattern='/logout', POST]
2025-05-22T13:00:52.190+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationServerMetadataEndpointFilter (9/26)
2025-05-22T13:00:52.190+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationEndpointFilter (10/26)
2025-05-22T13:00:52.190+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceVerificationEndpointFilter (11/26)
2025-05-22T13:00:52.191+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking OidcProviderConfigurationEndpointFilter (12/26)
2025-05-22T13:00:52.191+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking NimbusJwkSetEndpointFilter (13/26)
2025-05-22T13:00:52.191+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking OAuth2ClientAuthenticationFilter (14/26)
2025-05-22T13:00:52.192+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.s.authentication.ProviderManager     : Authenticating request with JwtClientAssertionAuthenticationProvider (1/22)
2025-05-22T13:00:52.193+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.s.authentication.ProviderManager     : Authenticating request with X509ClientCertificateAuthenticationProvider (2/22)
2025-05-22T13:00:52.193+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.s.authentication.ProviderManager     : Authenticating request with ClientSecretAuthenticationProvider (3/22)
2025-05-22T13:00:52.193+05:30 TRACE 97469 --- [http-nio-8080-exec-4] s.a.a.ClientSecretAuthenticationProvider : Retrieved registered client
2025-05-22T13:00:52.297+05:30 TRACE 97469 --- [http-nio-8080-exec-4] s.a.a.ClientSecretAuthenticationProvider : Validated client authentication parameters
2025-05-22T13:00:52.297+05:30 TRACE 97469 --- [http-nio-8080-exec-4] s.a.a.ClientSecretAuthenticationProvider : Authenticated client secret
2025-05-22T13:00:52.297+05:30 DEBUG 97469 --- [http-nio-8080-exec-4] o.s.a.w.OAuth2ClientAuthenticationFilter : Set SecurityContextHolder authentication to OAuth2ClientAuthenticationToken
2025-05-22T13:00:52.297+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking BearerTokenAuthenticationFilter (15/26)
2025-05-22T13:00:52.297+05:30 TRACE 97469 --- [http-nio-8080-exec-4] .s.r.w.a.BearerTokenAuthenticationFilter : Did not process request since did not find bearer token
2025-05-22T13:00:52.297+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking RequestCacheAwareFilter (16/26)
2025-05-22T13:00:52.297+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.s.w.s.HttpSessionRequestCache        : matchingRequestParameterName is required for getMatchingRequest to lookup a value, but not provided
2025-05-22T13:00:52.297+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderAwareRequestFilter (17/26)
2025-05-22T13:00:52.297+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking AnonymousAuthenticationFilter (18/26)
2025-05-22T13:00:52.297+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking ExceptionTranslationFilter (19/26)
2025-05-22T13:00:52.297+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking AuthorizationFilter (20/26)
2025-05-22T13:00:52.297+05:30 TRACE 97469 --- [http-nio-8080-exec-4] estMatcherDelegatingAuthorizationManager : Authorizing POST /oauth2/token
2025-05-22T13:00:52.298+05:30 TRACE 97469 --- [http-nio-8080-exec-4] estMatcherDelegatingAuthorizationManager : Checking authorization on POST /oauth2/token using org.springframework.security.authorization.AuthenticatedAuthorizationManager@2ee4386c
2025-05-22T13:00:52.298+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.s.w.a.AnonymousAuthenticationFilter  : Did not set SecurityContextHolder since already authenticated OAuth2ClientAuthenticationToken [Principal=registrar-client, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[]]
2025-05-22T13:00:52.298+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenEndpointFilter (21/26)
2025-05-22T13:00:52.299+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.s.authentication.ProviderManager     : Authenticating request with OAuth2ClientCredentialsAuthenticationProvider (1/22)
2025-05-22T13:00:52.299+05:30 TRACE 97469 --- [http-nio-8080-exec-4] 2ClientCredentialsAuthenticationProvider : Retrieved registered client
2025-05-22T13:00:52.299+05:30 TRACE 97469 --- [http-nio-8080-exec-4] 2ClientCredentialsAuthenticationProvider : Validated token request parameters
2025-05-22T13:00:52.323+05:30 TRACE 97469 --- [http-nio-8080-exec-4] 2ClientCredentialsAuthenticationProvider : Generated access token
2025-05-22T13:00:52.324+05:30 TRACE 97469 --- [http-nio-8080-exec-4] 2ClientCredentialsAuthenticationProvider : Saved authorization
2025-05-22T13:00:52.324+05:30 TRACE 97469 --- [http-nio-8080-exec-4] 2ClientCredentialsAuthenticationProvider : Authenticated token request
2025-05-22T13:00:52.328+05:30 TRACE 97469 --- [http-nio-8080-exec-4] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]
2025-05-22T13:01:20.784+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'authorizationServerSecurityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.OAuth2AuthorizationServerConfigurer$$Lambda$995/0x000000c8014b1d48@6097fca9] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Csrf, OidcLogoutEndpoint, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, OidcProviderConfigurationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint, OidcUserInfoEndpoint, OidcClientRegistrationEndpoint] (1/2)
2025-05-22T13:01:20.785+05:30 DEBUG 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing POST /oauth2/token
2025-05-22T13:01:20.785+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/26)
2025-05-22T13:01:20.785+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/26)
2025-05-22T13:01:20.785+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/26)
2025-05-22T13:01:20.785+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking AuthorizationServerContextFilter (4/26)
2025-05-22T13:01:20.785+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (5/26)
2025-05-22T13:01:20.785+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking CsrfFilter (6/26)
2025-05-22T13:01:20.785+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.csrf.CsrfFilter         : Did not protect against CSRF since request did not match And [CsrfNotRequired [TRACE, HEAD, GET, OPTIONS], Not [Or [Or [Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]], Ant [pattern='/.well-known/oauth-authorization-server', GET], Or [Ant [pattern='/oauth2/authorize', GET], Ant [pattern='/oauth2/authorize', POST]], Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST], Or [Ant [pattern='/oauth2/device_verification', GET], Ant [pattern='/oauth2/device_verification', POST]], Or [Ant [pattern='/.well-known/openid-configuration', GET], Or [Ant [pattern='/connect/logout', GET], Ant [pattern='/connect/logout', POST]], Or [Ant [pattern='/userinfo', GET], Ant [pattern='/userinfo', POST]], Or [Ant [pattern='/connect/register', POST], Ant [pattern='/connect/register', GET]]], Ant [pattern='/oauth2/jwks', GET]], org.springframework.security.config.annotation.web.configurers.oauth2.server.resource.OAuth2ResourceServerConfigurer$BearerTokenRequestMatcher@3c19592c]]]
2025-05-22T13:01:20.786+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking OidcLogoutEndpointFilter (7/26)
2025-05-22T13:01:20.786+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (8/26)
2025-05-22T13:01:20.786+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Ant [pattern='/logout', POST]
2025-05-22T13:01:20.786+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationServerMetadataEndpointFilter (9/26)
2025-05-22T13:01:20.786+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationEndpointFilter (10/26)
2025-05-22T13:01:20.786+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceVerificationEndpointFilter (11/26)
2025-05-22T13:01:20.786+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking OidcProviderConfigurationEndpointFilter (12/26)
2025-05-22T13:01:20.786+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking NimbusJwkSetEndpointFilter (13/26)
2025-05-22T13:01:20.786+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking OAuth2ClientAuthenticationFilter (14/26)
2025-05-22T13:01:20.787+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking BearerTokenAuthenticationFilter (15/26)
2025-05-22T13:01:20.787+05:30 TRACE 97469 --- [http-nio-8080-exec-6] .s.r.w.a.BearerTokenAuthenticationFilter : Did not process request since did not find bearer token
2025-05-22T13:01:20.788+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking RequestCacheAwareFilter (16/26)
2025-05-22T13:01:20.788+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.s.w.s.HttpSessionRequestCache        : matchingRequestParameterName is required for getMatchingRequest to lookup a value, but not provided
2025-05-22T13:01:20.788+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderAwareRequestFilter (17/26)
2025-05-22T13:01:20.788+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking AnonymousAuthenticationFilter (18/26)
2025-05-22T13:01:20.788+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking ExceptionTranslationFilter (19/26)
2025-05-22T13:01:20.788+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking AuthorizationFilter (20/26)
2025-05-22T13:01:20.788+05:30 TRACE 97469 --- [http-nio-8080-exec-6] estMatcherDelegatingAuthorizationManager : Authorizing POST /oauth2/token
2025-05-22T13:01:20.788+05:30 TRACE 97469 --- [http-nio-8080-exec-6] estMatcherDelegatingAuthorizationManager : Checking authorization on POST /oauth2/token using org.springframework.security.authorization.AuthenticatedAuthorizationManager@2ee4386c
2025-05-22T13:01:20.788+05:30 TRACE 97469 --- [http-nio-8080-exec-6] w.c.HttpSessionSecurityContextRepository : No HttpSession currently exists
2025-05-22T13:01:20.788+05:30 TRACE 97469 --- [http-nio-8080-exec-6] .s.s.w.c.SupplierDeferredSecurityContext : Created SecurityContextImpl [Null authentication]
2025-05-22T13:01:20.788+05:30 TRACE 97469 --- [http-nio-8080-exec-6] .s.s.w.c.SupplierDeferredSecurityContext : Created SecurityContextImpl [Null authentication]
2025-05-22T13:01:20.788+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to AnonymousAuthenticationToken [Principal=anonymousUser, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ANONYMOUS]]
2025-05-22T13:01:20.788+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.s.w.a.ExceptionTranslationFilter     : Sending AnonymousAuthenticationToken [Principal=anonymousUser, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[ROLE_ANONYMOUS]] to authentication entry point since access is denied

org.springframework.security.authorization.AuthorizationDeniedException: Access Denied
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:99) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.resource.web.authentication.BearerTokenAuthenticationFilter.doFilterInternal(BearerTokenAuthenticationFilter.java:128) ~[spring-security-oauth2-resource-server-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2ClientAuthenticationFilter.doFilterInternal(OAuth2ClientAuthenticationFilter.java:144) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.NimbusJwkSetEndpointFilter.doFilterInternal(NimbusJwkSetEndpointFilter.java:88) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.oidc.web.OidcProviderConfigurationEndpointFilter.doFilterInternal(OidcProviderConfigurationEndpointFilter.java:91) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2DeviceVerificationEndpointFilter.doFilterInternal(OAuth2DeviceVerificationEndpointFilter.java:152) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2AuthorizationEndpointFilter.doFilterInternal(OAuth2AuthorizationEndpointFilter.java:175) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2AuthorizationServerMetadataEndpointFilter.doFilterInternal(OAuth2AuthorizationServerMetadataEndpointFilter.java:90) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.oidc.web.OidcLogoutEndpointFilter.doFilterInternal(OidcLogoutEndpointFilter.java:105) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.csrf.CsrfFilter.doFilterInternal(CsrfFilter.java:117) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.AuthorizationServerContextFilter.doFilterInternal(AuthorizationServerContextFilter.java:69) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243) ~[spring-webmvc-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238) ~[spring-security-config-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

2025-05-22T13:01:20.790+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.s.w.s.HttpSessionRequestCache        : Did not save request since it did not match [And [Ant [pattern='/**', GET], Not [Ant [pattern='/**/favicon.*']], Not [MediaTypeRequestMatcher [contentNegotiationStrategy=org.springframework.web.accept.ContentNegotiationManager@75c6396f, matchingMediaTypes=[application/json], useEquals=false, ignoredMediaTypes=[*/*]]], Not [RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]], Not [MediaTypeRequestMatcher [contentNegotiationStrategy=org.springframework.web.accept.ContentNegotiationManager@75c6396f, matchingMediaTypes=[multipart/form-data], useEquals=false, ignoredMediaTypes=[*/*]]], Not [MediaTypeRequestMatcher [contentNegotiationStrategy=org.springframework.web.accept.ContentNegotiationManager@75c6396f, matchingMediaTypes=[text/event-stream], useEquals=false, ignoredMediaTypes=[*/*]]]]]
2025-05-22T13:01:20.790+05:30 DEBUG 97469 --- [http-nio-8080-exec-6] s.w.a.DelegatingAuthenticationEntryPoint : Trying to match using Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]]
2025-05-22T13:01:20.790+05:30 DEBUG 97469 --- [http-nio-8080-exec-6] s.w.a.DelegatingAuthenticationEntryPoint : Match found! Executing org.springframework.security.web.authentication.HttpStatusEntryPoint@26e56178
2025-05-22T13:01:20.790+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]
2025-05-22T13:01:39.682+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'authorizationServerSecurityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.OAuth2AuthorizationServerConfigurer$$Lambda$995/0x000000c8014b1d48@6097fca9] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Csrf, OidcLogoutEndpoint, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, OidcProviderConfigurationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint, OidcUserInfoEndpoint, OidcClientRegistrationEndpoint] (1/2)
2025-05-22T13:01:39.682+05:30 DEBUG 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing POST /oauth2/token
2025-05-22T13:01:39.682+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/26)
2025-05-22T13:01:39.682+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/26)
2025-05-22T13:01:39.682+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/26)
2025-05-22T13:01:39.682+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking AuthorizationServerContextFilter (4/26)
2025-05-22T13:01:39.683+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (5/26)
2025-05-22T13:01:39.683+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking CsrfFilter (6/26)
2025-05-22T13:01:39.683+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.csrf.CsrfFilter         : Did not protect against CSRF since request did not match And [CsrfNotRequired [TRACE, HEAD, GET, OPTIONS], Not [Or [Or [Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]], Ant [pattern='/.well-known/oauth-authorization-server', GET], Or [Ant [pattern='/oauth2/authorize', GET], Ant [pattern='/oauth2/authorize', POST]], Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST], Or [Ant [pattern='/oauth2/device_verification', GET], Ant [pattern='/oauth2/device_verification', POST]], Or [Ant [pattern='/.well-known/openid-configuration', GET], Or [Ant [pattern='/connect/logout', GET], Ant [pattern='/connect/logout', POST]], Or [Ant [pattern='/userinfo', GET], Ant [pattern='/userinfo', POST]], Or [Ant [pattern='/connect/register', POST], Ant [pattern='/connect/register', GET]]], Ant [pattern='/oauth2/jwks', GET]], org.springframework.security.config.annotation.web.configurers.oauth2.server.resource.OAuth2ResourceServerConfigurer$BearerTokenRequestMatcher@3c19592c]]]
2025-05-22T13:01:39.683+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking OidcLogoutEndpointFilter (7/26)
2025-05-22T13:01:39.683+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (8/26)
2025-05-22T13:01:39.683+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Ant [pattern='/logout', POST]
2025-05-22T13:01:39.683+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationServerMetadataEndpointFilter (9/26)
2025-05-22T13:01:39.683+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationEndpointFilter (10/26)
2025-05-22T13:01:39.683+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceVerificationEndpointFilter (11/26)
2025-05-22T13:01:39.684+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking OidcProviderConfigurationEndpointFilter (12/26)
2025-05-22T13:01:39.684+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking NimbusJwkSetEndpointFilter (13/26)
2025-05-22T13:01:39.684+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking OAuth2ClientAuthenticationFilter (14/26)
2025-05-22T13:01:39.684+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking BearerTokenAuthenticationFilter (15/26)
2025-05-22T13:01:39.686+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.s.authentication.ProviderManager     : Authenticating request with JwtAuthenticationProvider (1/22)
2025-05-22T13:01:39.692+05:30 TRACE 97469 --- [http-nio-8080-exec-7] s.o.s.r.a.JwtGrantedAuthoritiesConverter : Returning no authorities since could not find any claims that might contain scopes
2025-05-22T13:01:39.692+05:30 DEBUG 97469 --- [http-nio-8080-exec-7] o.s.s.o.s.r.a.JwtAuthenticationProvider  : Authenticated token
2025-05-22T13:01:39.692+05:30 DEBUG 97469 --- [http-nio-8080-exec-7] .s.r.w.a.BearerTokenAuthenticationFilter : Set SecurityContextHolder to JwtAuthenticationToken [Principal=org.springframework.security.oauth2.jwt.Jwt@42591e4, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[]]
2025-05-22T13:01:39.692+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking RequestCacheAwareFilter (16/26)
2025-05-22T13:01:39.692+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.s.w.s.HttpSessionRequestCache        : matchingRequestParameterName is required for getMatchingRequest to lookup a value, but not provided
2025-05-22T13:01:39.692+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderAwareRequestFilter (17/26)
2025-05-22T13:01:39.692+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking AnonymousAuthenticationFilter (18/26)
2025-05-22T13:01:39.692+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking ExceptionTranslationFilter (19/26)
2025-05-22T13:01:39.692+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking AuthorizationFilter (20/26)
2025-05-22T13:01:39.692+05:30 TRACE 97469 --- [http-nio-8080-exec-7] estMatcherDelegatingAuthorizationManager : Authorizing POST /oauth2/token
2025-05-22T13:01:39.692+05:30 TRACE 97469 --- [http-nio-8080-exec-7] estMatcherDelegatingAuthorizationManager : Checking authorization on POST /oauth2/token using org.springframework.security.authorization.AuthenticatedAuthorizationManager@2ee4386c
2025-05-22T13:01:39.692+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.s.w.a.AnonymousAuthenticationFilter  : Did not set SecurityContextHolder since already authenticated JwtAuthenticationToken [Principal=org.springframework.security.oauth2.jwt.Jwt@42591e4, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[]]
2025-05-22T13:01:39.693+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenEndpointFilter (21/26)
2025-05-22T13:01:39.693+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.s.o.s.a.w.OAuth2TokenEndpointFilter  : Token request failed: [invalid_request] OAuth 2.0 Parameter: grant_type

org.springframework.security.oauth2.core.OAuth2AuthenticationException: OAuth 2.0 Parameter: grant_type
	at org.springframework.security.oauth2.server.authorization.web.OAuth2TokenEndpointFilter.throwError(OAuth2TokenEndpointFilter.java:233) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2TokenEndpointFilter.doFilterInternal(OAuth2TokenEndpointFilter.java:157) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:101) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.resource.web.authentication.BearerTokenAuthenticationFilter.doFilterInternal(BearerTokenAuthenticationFilter.java:145) ~[spring-security-oauth2-resource-server-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2ClientAuthenticationFilter.doFilterInternal(OAuth2ClientAuthenticationFilter.java:144) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.NimbusJwkSetEndpointFilter.doFilterInternal(NimbusJwkSetEndpointFilter.java:88) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.oidc.web.OidcProviderConfigurationEndpointFilter.doFilterInternal(OidcProviderConfigurationEndpointFilter.java:91) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2DeviceVerificationEndpointFilter.doFilterInternal(OAuth2DeviceVerificationEndpointFilter.java:152) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2AuthorizationEndpointFilter.doFilterInternal(OAuth2AuthorizationEndpointFilter.java:175) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2AuthorizationServerMetadataEndpointFilter.doFilterInternal(OAuth2AuthorizationServerMetadataEndpointFilter.java:90) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.oidc.web.OidcLogoutEndpointFilter.doFilterInternal(OidcLogoutEndpointFilter.java:105) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.csrf.CsrfFilter.doFilterInternal(CsrfFilter.java:117) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.AuthorizationServerContextFilter.doFilterInternal(AuthorizationServerContextFilter.java:69) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243) ~[spring-webmvc-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238) ~[spring-security-config-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

2025-05-22T13:01:39.695+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]
2025-05-22T13:02:06.890+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'authorizationServerSecurityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.OAuth2AuthorizationServerConfigurer$$Lambda$995/0x000000c8014b1d48@6097fca9] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Csrf, OidcLogoutEndpoint, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, OidcProviderConfigurationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint, OidcUserInfoEndpoint, OidcClientRegistrationEndpoint] (1/2)
2025-05-22T13:02:06.891+05:30 DEBUG 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing POST /oauth2/token
2025-05-22T13:02:06.891+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/26)
2025-05-22T13:02:06.891+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/26)
2025-05-22T13:02:06.891+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/26)
2025-05-22T13:02:06.891+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking AuthorizationServerContextFilter (4/26)
2025-05-22T13:02:06.891+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (5/26)
2025-05-22T13:02:06.891+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking CsrfFilter (6/26)
2025-05-22T13:02:06.892+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.csrf.CsrfFilter         : Did not protect against CSRF since request did not match And [CsrfNotRequired [TRACE, HEAD, GET, OPTIONS], Not [Or [Or [Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]], Ant [pattern='/.well-known/oauth-authorization-server', GET], Or [Ant [pattern='/oauth2/authorize', GET], Ant [pattern='/oauth2/authorize', POST]], Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST], Or [Ant [pattern='/oauth2/device_verification', GET], Ant [pattern='/oauth2/device_verification', POST]], Or [Ant [pattern='/.well-known/openid-configuration', GET], Or [Ant [pattern='/connect/logout', GET], Ant [pattern='/connect/logout', POST]], Or [Ant [pattern='/userinfo', GET], Ant [pattern='/userinfo', POST]], Or [Ant [pattern='/connect/register', POST], Ant [pattern='/connect/register', GET]]], Ant [pattern='/oauth2/jwks', GET]], org.springframework.security.config.annotation.web.configurers.oauth2.server.resource.OAuth2ResourceServerConfigurer$BearerTokenRequestMatcher@3c19592c]]]
2025-05-22T13:02:06.892+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking OidcLogoutEndpointFilter (7/26)
2025-05-22T13:02:06.892+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (8/26)
2025-05-22T13:02:06.892+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Ant [pattern='/logout', POST]
2025-05-22T13:02:06.892+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationServerMetadataEndpointFilter (9/26)
2025-05-22T13:02:06.892+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationEndpointFilter (10/26)
2025-05-22T13:02:06.892+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceVerificationEndpointFilter (11/26)
2025-05-22T13:02:06.892+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking OidcProviderConfigurationEndpointFilter (12/26)
2025-05-22T13:02:06.892+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking NimbusJwkSetEndpointFilter (13/26)
2025-05-22T13:02:06.892+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking OAuth2ClientAuthenticationFilter (14/26)
2025-05-22T13:02:06.893+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.s.authentication.ProviderManager     : Authenticating request with JwtClientAssertionAuthenticationProvider (1/22)
2025-05-22T13:02:06.893+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.s.authentication.ProviderManager     : Authenticating request with X509ClientCertificateAuthenticationProvider (2/22)
2025-05-22T13:02:06.893+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.s.authentication.ProviderManager     : Authenticating request with ClientSecretAuthenticationProvider (3/22)
2025-05-22T13:02:06.893+05:30 TRACE 97469 --- [http-nio-8080-exec-8] s.a.a.ClientSecretAuthenticationProvider : Retrieved registered client
2025-05-22T13:02:06.996+05:30 TRACE 97469 --- [http-nio-8080-exec-8] s.a.a.ClientSecretAuthenticationProvider : Validated client authentication parameters
2025-05-22T13:02:06.996+05:30 TRACE 97469 --- [http-nio-8080-exec-8] s.a.a.ClientSecretAuthenticationProvider : Authenticated client secret
2025-05-22T13:02:06.997+05:30 DEBUG 97469 --- [http-nio-8080-exec-8] o.s.a.w.OAuth2ClientAuthenticationFilter : Set SecurityContextHolder authentication to OAuth2ClientAuthenticationToken
2025-05-22T13:02:06.997+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking BearerTokenAuthenticationFilter (15/26)
2025-05-22T13:02:06.997+05:30 TRACE 97469 --- [http-nio-8080-exec-8] .s.r.w.a.BearerTokenAuthenticationFilter : Did not process request since did not find bearer token
2025-05-22T13:02:06.997+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking RequestCacheAwareFilter (16/26)
2025-05-22T13:02:06.997+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.s.w.s.HttpSessionRequestCache        : matchingRequestParameterName is required for getMatchingRequest to lookup a value, but not provided
2025-05-22T13:02:06.997+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderAwareRequestFilter (17/26)
2025-05-22T13:02:06.997+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking AnonymousAuthenticationFilter (18/26)
2025-05-22T13:02:06.997+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking ExceptionTranslationFilter (19/26)
2025-05-22T13:02:06.997+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking AuthorizationFilter (20/26)
2025-05-22T13:02:06.997+05:30 TRACE 97469 --- [http-nio-8080-exec-8] estMatcherDelegatingAuthorizationManager : Authorizing POST /oauth2/token
2025-05-22T13:02:06.997+05:30 TRACE 97469 --- [http-nio-8080-exec-8] estMatcherDelegatingAuthorizationManager : Checking authorization on POST /oauth2/token using org.springframework.security.authorization.AuthenticatedAuthorizationManager@2ee4386c
2025-05-22T13:02:06.997+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.s.w.a.AnonymousAuthenticationFilter  : Did not set SecurityContextHolder since already authenticated OAuth2ClientAuthenticationToken [Principal=registrar-client, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[]]
2025-05-22T13:02:06.997+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenEndpointFilter (21/26)
2025-05-22T13:02:06.997+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.s.authentication.ProviderManager     : Authenticating request with OAuth2ClientCredentialsAuthenticationProvider (1/22)
2025-05-22T13:02:06.997+05:30 TRACE 97469 --- [http-nio-8080-exec-8] 2ClientCredentialsAuthenticationProvider : Retrieved registered client
2025-05-22T13:02:06.997+05:30 TRACE 97469 --- [http-nio-8080-exec-8] 2ClientCredentialsAuthenticationProvider : Validated token request parameters
2025-05-22T13:02:07.005+05:30 TRACE 97469 --- [http-nio-8080-exec-8] 2ClientCredentialsAuthenticationProvider : Generated access token
2025-05-22T13:02:07.005+05:30 TRACE 97469 --- [http-nio-8080-exec-8] 2ClientCredentialsAuthenticationProvider : Saved authorization
2025-05-22T13:02:07.005+05:30 TRACE 97469 --- [http-nio-8080-exec-8] 2ClientCredentialsAuthenticationProvider : Authenticated token request
2025-05-22T13:02:07.005+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]
2025-05-22T13:02:28.462+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'authorizationServerSecurityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.OAuth2AuthorizationServerConfigurer$$Lambda$995/0x000000c8014b1d48@6097fca9] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Csrf, OidcLogoutEndpoint, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, OidcProviderConfigurationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint, OidcUserInfoEndpoint, OidcClientRegistrationEndpoint] (1/2)
2025-05-22T13:02:28.463+05:30 DEBUG 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing POST /oauth2/token
2025-05-22T13:02:28.463+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/26)
2025-05-22T13:02:28.463+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/26)
2025-05-22T13:02:28.463+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/26)
2025-05-22T13:02:28.463+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking AuthorizationServerContextFilter (4/26)
2025-05-22T13:02:28.463+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (5/26)
2025-05-22T13:02:28.463+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking CsrfFilter (6/26)
2025-05-22T13:02:28.463+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.csrf.CsrfFilter         : Did not protect against CSRF since request did not match And [CsrfNotRequired [TRACE, HEAD, GET, OPTIONS], Not [Or [Or [Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]], Ant [pattern='/.well-known/oauth-authorization-server', GET], Or [Ant [pattern='/oauth2/authorize', GET], Ant [pattern='/oauth2/authorize', POST]], Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST], Or [Ant [pattern='/oauth2/device_verification', GET], Ant [pattern='/oauth2/device_verification', POST]], Or [Ant [pattern='/.well-known/openid-configuration', GET], Or [Ant [pattern='/connect/logout', GET], Ant [pattern='/connect/logout', POST]], Or [Ant [pattern='/userinfo', GET], Ant [pattern='/userinfo', POST]], Or [Ant [pattern='/connect/register', POST], Ant [pattern='/connect/register', GET]]], Ant [pattern='/oauth2/jwks', GET]], org.springframework.security.config.annotation.web.configurers.oauth2.server.resource.OAuth2ResourceServerConfigurer$BearerTokenRequestMatcher@3c19592c]]]
2025-05-22T13:02:28.463+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking OidcLogoutEndpointFilter (7/26)
2025-05-22T13:02:28.464+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (8/26)
2025-05-22T13:02:28.464+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Ant [pattern='/logout', POST]
2025-05-22T13:02:28.464+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationServerMetadataEndpointFilter (9/26)
2025-05-22T13:02:28.464+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationEndpointFilter (10/26)
2025-05-22T13:02:28.464+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceVerificationEndpointFilter (11/26)
2025-05-22T13:02:28.464+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking OidcProviderConfigurationEndpointFilter (12/26)
2025-05-22T13:02:28.464+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking NimbusJwkSetEndpointFilter (13/26)
2025-05-22T13:02:28.464+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking OAuth2ClientAuthenticationFilter (14/26)
2025-05-22T13:02:28.464+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking BearerTokenAuthenticationFilter (15/26)
2025-05-22T13:02:28.464+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.s.authentication.ProviderManager     : Authenticating request with JwtAuthenticationProvider (1/22)
2025-05-22T13:02:28.466+05:30 TRACE 97469 --- [http-nio-8080-exec-10] s.o.s.r.a.JwtGrantedAuthoritiesConverter : Returning no authorities since could not find any claims that might contain scopes
2025-05-22T13:02:28.466+05:30 DEBUG 97469 --- [http-nio-8080-exec-10] o.s.s.o.s.r.a.JwtAuthenticationProvider  : Authenticated token
2025-05-22T13:02:28.466+05:30 DEBUG 97469 --- [http-nio-8080-exec-10] .s.r.w.a.BearerTokenAuthenticationFilter : Set SecurityContextHolder to JwtAuthenticationToken [Principal=org.springframework.security.oauth2.jwt.Jwt@4c11c150, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[]]
2025-05-22T13:02:28.466+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking RequestCacheAwareFilter (16/26)
2025-05-22T13:02:28.466+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.s.w.s.HttpSessionRequestCache        : matchingRequestParameterName is required for getMatchingRequest to lookup a value, but not provided
2025-05-22T13:02:28.466+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderAwareRequestFilter (17/26)
2025-05-22T13:02:28.466+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking AnonymousAuthenticationFilter (18/26)
2025-05-22T13:02:28.466+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking ExceptionTranslationFilter (19/26)
2025-05-22T13:02:28.466+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking AuthorizationFilter (20/26)
2025-05-22T13:02:28.466+05:30 TRACE 97469 --- [http-nio-8080-exec-10] estMatcherDelegatingAuthorizationManager : Authorizing POST /oauth2/token
2025-05-22T13:02:28.466+05:30 TRACE 97469 --- [http-nio-8080-exec-10] estMatcherDelegatingAuthorizationManager : Checking authorization on POST /oauth2/token using org.springframework.security.authorization.AuthenticatedAuthorizationManager@2ee4386c
2025-05-22T13:02:28.466+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.s.w.a.AnonymousAuthenticationFilter  : Did not set SecurityContextHolder since already authenticated JwtAuthenticationToken [Principal=org.springframework.security.oauth2.jwt.Jwt@4c11c150, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[]]
2025-05-22T13:02:28.466+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenEndpointFilter (21/26)
2025-05-22T13:02:28.466+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.s.o.s.a.w.OAuth2TokenEndpointFilter  : Token request failed: [invalid_request] OAuth 2.0 Parameter: grant_type

org.springframework.security.oauth2.core.OAuth2AuthenticationException: OAuth 2.0 Parameter: grant_type
	at org.springframework.security.oauth2.server.authorization.web.OAuth2TokenEndpointFilter.throwError(OAuth2TokenEndpointFilter.java:233) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2TokenEndpointFilter.doFilterInternal(OAuth2TokenEndpointFilter.java:157) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:101) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.resource.web.authentication.BearerTokenAuthenticationFilter.doFilterInternal(BearerTokenAuthenticationFilter.java:145) ~[spring-security-oauth2-resource-server-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2ClientAuthenticationFilter.doFilterInternal(OAuth2ClientAuthenticationFilter.java:144) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.NimbusJwkSetEndpointFilter.doFilterInternal(NimbusJwkSetEndpointFilter.java:88) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.oidc.web.OidcProviderConfigurationEndpointFilter.doFilterInternal(OidcProviderConfigurationEndpointFilter.java:91) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2DeviceVerificationEndpointFilter.doFilterInternal(OAuth2DeviceVerificationEndpointFilter.java:152) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2AuthorizationEndpointFilter.doFilterInternal(OAuth2AuthorizationEndpointFilter.java:175) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2AuthorizationServerMetadataEndpointFilter.doFilterInternal(OAuth2AuthorizationServerMetadataEndpointFilter.java:90) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.oidc.web.OidcLogoutEndpointFilter.doFilterInternal(OidcLogoutEndpointFilter.java:105) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.csrf.CsrfFilter.doFilterInternal(CsrfFilter.java:117) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.AuthorizationServerContextFilter.doFilterInternal(AuthorizationServerContextFilter.java:69) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243) ~[spring-webmvc-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238) ~[spring-security-config-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

2025-05-22T13:02:28.468+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]
2025-05-22T13:05:13.050+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'authorizationServerSecurityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.OAuth2AuthorizationServerConfigurer$$Lambda$995/0x000000c8014b1d48@6097fca9] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Csrf, OidcLogoutEndpoint, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, OidcProviderConfigurationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint, OidcUserInfoEndpoint, OidcClientRegistrationEndpoint] (1/2)
2025-05-22T13:05:13.050+05:30 DEBUG 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Securing POST /oauth2/token
2025-05-22T13:05:13.050+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/26)
2025-05-22T13:05:13.050+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/26)
2025-05-22T13:05:13.050+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/26)
2025-05-22T13:05:13.050+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking AuthorizationServerContextFilter (4/26)
2025-05-22T13:05:13.050+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (5/26)
2025-05-22T13:05:13.051+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking CsrfFilter (6/26)
2025-05-22T13:05:13.051+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.csrf.CsrfFilter         : Did not protect against CSRF since request did not match And [CsrfNotRequired [TRACE, HEAD, GET, OPTIONS], Not [Or [Or [Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]], Ant [pattern='/.well-known/oauth-authorization-server', GET], Or [Ant [pattern='/oauth2/authorize', GET], Ant [pattern='/oauth2/authorize', POST]], Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST], Or [Ant [pattern='/oauth2/device_verification', GET], Ant [pattern='/oauth2/device_verification', POST]], Or [Ant [pattern='/.well-known/openid-configuration', GET], Or [Ant [pattern='/connect/logout', GET], Ant [pattern='/connect/logout', POST]], Or [Ant [pattern='/userinfo', GET], Ant [pattern='/userinfo', POST]], Or [Ant [pattern='/connect/register', POST], Ant [pattern='/connect/register', GET]]], Ant [pattern='/oauth2/jwks', GET]], org.springframework.security.config.annotation.web.configurers.oauth2.server.resource.OAuth2ResourceServerConfigurer$BearerTokenRequestMatcher@3c19592c]]]
2025-05-22T13:05:13.051+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking OidcLogoutEndpointFilter (7/26)
2025-05-22T13:05:13.051+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (8/26)
2025-05-22T13:05:13.051+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Ant [pattern='/logout', POST]
2025-05-22T13:05:13.051+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationServerMetadataEndpointFilter (9/26)
2025-05-22T13:05:13.051+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationEndpointFilter (10/26)
2025-05-22T13:05:13.051+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceVerificationEndpointFilter (11/26)
2025-05-22T13:05:13.051+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking OidcProviderConfigurationEndpointFilter (12/26)
2025-05-22T13:05:13.051+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking NimbusJwkSetEndpointFilter (13/26)
2025-05-22T13:05:13.051+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking OAuth2ClientAuthenticationFilter (14/26)
2025-05-22T13:05:13.052+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.s.authentication.ProviderManager     : Authenticating request with JwtClientAssertionAuthenticationProvider (1/22)
2025-05-22T13:05:13.052+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.s.authentication.ProviderManager     : Authenticating request with X509ClientCertificateAuthenticationProvider (2/22)
2025-05-22T13:05:13.052+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.s.authentication.ProviderManager     : Authenticating request with ClientSecretAuthenticationProvider (3/22)
2025-05-22T13:05:13.052+05:30 TRACE 97469 --- [http-nio-8080-exec-1] s.a.a.ClientSecretAuthenticationProvider : Retrieved registered client
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] s.a.a.ClientSecretAuthenticationProvider : Validated client authentication parameters
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] s.a.a.ClientSecretAuthenticationProvider : Authenticated client secret
2025-05-22T13:05:13.154+05:30 DEBUG 97469 --- [http-nio-8080-exec-1] o.s.a.w.OAuth2ClientAuthenticationFilter : Set SecurityContextHolder authentication to OAuth2ClientAuthenticationToken
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking BearerTokenAuthenticationFilter (15/26)
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] .s.r.w.a.BearerTokenAuthenticationFilter : Did not process request since did not find bearer token
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking RequestCacheAwareFilter (16/26)
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.s.w.s.HttpSessionRequestCache        : matchingRequestParameterName is required for getMatchingRequest to lookup a value, but not provided
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderAwareRequestFilter (17/26)
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking AnonymousAuthenticationFilter (18/26)
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking ExceptionTranslationFilter (19/26)
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking AuthorizationFilter (20/26)
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] estMatcherDelegatingAuthorizationManager : Authorizing POST /oauth2/token
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] estMatcherDelegatingAuthorizationManager : Checking authorization on POST /oauth2/token using org.springframework.security.authorization.AuthenticatedAuthorizationManager@2ee4386c
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.s.w.a.AnonymousAuthenticationFilter  : Did not set SecurityContextHolder since already authenticated OAuth2ClientAuthenticationToken [Principal=registrar-client, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[]]
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenEndpointFilter (21/26)
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.s.authentication.ProviderManager     : Authenticating request with OAuth2ClientCredentialsAuthenticationProvider (1/22)
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] 2ClientCredentialsAuthenticationProvider : Retrieved registered client
2025-05-22T13:05:13.154+05:30 TRACE 97469 --- [http-nio-8080-exec-1] 2ClientCredentialsAuthenticationProvider : Validated token request parameters
2025-05-22T13:05:13.162+05:30 TRACE 97469 --- [http-nio-8080-exec-1] 2ClientCredentialsAuthenticationProvider : Generated access token
2025-05-22T13:05:13.162+05:30 TRACE 97469 --- [http-nio-8080-exec-1] 2ClientCredentialsAuthenticationProvider : Saved authorization
2025-05-22T13:05:13.162+05:30 TRACE 97469 --- [http-nio-8080-exec-1] 2ClientCredentialsAuthenticationProvider : Authenticated token request
2025-05-22T13:05:13.163+05:30 TRACE 97469 --- [http-nio-8080-exec-1] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]
2025-05-22T13:05:30.944+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'authorizationServerSecurityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.OAuth2AuthorizationServerConfigurer$$Lambda$995/0x000000c8014b1d48@6097fca9] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Csrf, OidcLogoutEndpoint, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, OidcProviderConfigurationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint, OidcUserInfoEndpoint, OidcClientRegistrationEndpoint] (1/2)
2025-05-22T13:05:30.944+05:30 DEBUG 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Securing POST /connect/register
2025-05-22T13:05:30.944+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/26)
2025-05-22T13:05:30.944+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/26)
2025-05-22T13:05:30.944+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/26)
2025-05-22T13:05:30.945+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking AuthorizationServerContextFilter (4/26)
2025-05-22T13:05:30.945+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (5/26)
2025-05-22T13:05:30.945+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking CsrfFilter (6/26)
2025-05-22T13:05:30.945+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.csrf.CsrfFilter         : Did not protect against CSRF since request did not match And [CsrfNotRequired [TRACE, HEAD, GET, OPTIONS], Not [Or [Or [Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]], Ant [pattern='/.well-known/oauth-authorization-server', GET], Or [Ant [pattern='/oauth2/authorize', GET], Ant [pattern='/oauth2/authorize', POST]], Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST], Or [Ant [pattern='/oauth2/device_verification', GET], Ant [pattern='/oauth2/device_verification', POST]], Or [Ant [pattern='/.well-known/openid-configuration', GET], Or [Ant [pattern='/connect/logout', GET], Ant [pattern='/connect/logout', POST]], Or [Ant [pattern='/userinfo', GET], Ant [pattern='/userinfo', POST]], Or [Ant [pattern='/connect/register', POST], Ant [pattern='/connect/register', GET]]], Ant [pattern='/oauth2/jwks', GET]], org.springframework.security.config.annotation.web.configurers.oauth2.server.resource.OAuth2ResourceServerConfigurer$BearerTokenRequestMatcher@3c19592c]]]
2025-05-22T13:05:30.945+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking OidcLogoutEndpointFilter (7/26)
2025-05-22T13:05:30.945+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (8/26)
2025-05-22T13:05:30.945+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Ant [pattern='/logout', POST]
2025-05-22T13:05:30.945+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationServerMetadataEndpointFilter (9/26)
2025-05-22T13:05:30.945+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationEndpointFilter (10/26)
2025-05-22T13:05:30.945+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceVerificationEndpointFilter (11/26)
2025-05-22T13:05:30.945+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking OidcProviderConfigurationEndpointFilter (12/26)
2025-05-22T13:05:30.945+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking NimbusJwkSetEndpointFilter (13/26)
2025-05-22T13:05:30.945+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking OAuth2ClientAuthenticationFilter (14/26)
2025-05-22T13:05:30.945+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking BearerTokenAuthenticationFilter (15/26)
2025-05-22T13:05:30.946+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.s.authentication.ProviderManager     : Authenticating request with JwtAuthenticationProvider (1/22)
2025-05-22T13:05:30.947+05:30 TRACE 97469 --- [http-nio-8080-exec-3] s.o.s.r.a.JwtGrantedAuthoritiesConverter : Looking for scopes in claim scope
2025-05-22T13:05:30.947+05:30 DEBUG 97469 --- [http-nio-8080-exec-3] o.s.s.o.s.r.a.JwtAuthenticationProvider  : Authenticated token
2025-05-22T13:05:30.947+05:30 DEBUG 97469 --- [http-nio-8080-exec-3] .s.r.w.a.BearerTokenAuthenticationFilter : Set SecurityContextHolder to JwtAuthenticationToken [Principal=org.springframework.security.oauth2.jwt.Jwt@9bbc25c5, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[SCOPE_client.create]]
2025-05-22T13:05:30.947+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking RequestCacheAwareFilter (16/26)
2025-05-22T13:05:30.947+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.s.w.s.HttpSessionRequestCache        : matchingRequestParameterName is required for getMatchingRequest to lookup a value, but not provided
2025-05-22T13:05:30.947+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderAwareRequestFilter (17/26)
2025-05-22T13:05:30.947+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking AnonymousAuthenticationFilter (18/26)
2025-05-22T13:05:30.947+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking ExceptionTranslationFilter (19/26)
2025-05-22T13:05:30.947+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking AuthorizationFilter (20/26)
2025-05-22T13:05:30.948+05:30 TRACE 97469 --- [http-nio-8080-exec-3] estMatcherDelegatingAuthorizationManager : Authorizing POST /connect/register
2025-05-22T13:05:30.948+05:30 TRACE 97469 --- [http-nio-8080-exec-3] estMatcherDelegatingAuthorizationManager : Checking authorization on POST /connect/register using org.springframework.security.authorization.AuthenticatedAuthorizationManager@2ee4386c
2025-05-22T13:05:30.948+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.s.w.a.AnonymousAuthenticationFilter  : Did not set SecurityContextHolder since already authenticated JwtAuthenticationToken [Principal=org.springframework.security.oauth2.jwt.Jwt@9bbc25c5, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=0:0:0:0:0:0:0:1, SessionId=null], Granted Authorities=[SCOPE_client.create]]
2025-05-22T13:05:30.948+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenEndpointFilter (21/26)
2025-05-22T13:05:30.948+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenIntrospectionEndpointFilter (22/26)
2025-05-22T13:05:30.948+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenRevocationEndpointFilter (23/26)
2025-05-22T13:05:30.948+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceAuthorizationEndpointFilter (24/26)
2025-05-22T13:05:30.948+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking OidcUserInfoEndpointFilter (25/26)
2025-05-22T13:05:30.948+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.security.web.FilterChainProxy        : Invoking OidcClientRegistrationEndpointFilter (26/26)
2025-05-22T13:05:30.953+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.s.authentication.ProviderManager     : Authenticating request with OidcClientRegistrationAuthenticationProvider (1/22)
2025-05-22T13:05:30.953+05:30 TRACE 97469 --- [http-nio-8080-exec-3] ClientRegistrationAuthenticationProvider : Retrieved authorization with initial access token
2025-05-22T13:05:30.953+05:30 TRACE 97469 --- [http-nio-8080-exec-3] ClientRegistrationAuthenticationProvider : Validated client registration request parameters
2025-05-22T13:05:31.049+05:30 TRACE 97469 --- [http-nio-8080-exec-3] ClientRegistrationAuthenticationProvider : Saved registered client
2025-05-22T13:05:31.057+05:30 TRACE 97469 --- [http-nio-8080-exec-3] ClientRegistrationAuthenticationProvider : Generated registration access token
2025-05-22T13:05:31.058+05:30 TRACE 97469 --- [http-nio-8080-exec-3] ClientRegistrationAuthenticationProvider : Saved authorization with registration access token
2025-05-22T13:05:31.058+05:30 TRACE 97469 --- [http-nio-8080-exec-3] ClientRegistrationAuthenticationProvider : Saved authorization with invalidated initial access token
2025-05-22T13:05:31.059+05:30 TRACE 97469 --- [http-nio-8080-exec-3] ClientRegistrationAuthenticationProvider : Authenticated client registration request
2025-05-22T13:05:31.060+05:30 TRACE 97469 --- [http-nio-8080-exec-3] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]
2025-05-22T13:06:01.005+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'authorizationServerSecurityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.OAuth2AuthorizationServerConfigurer$$Lambda$995/0x000000c8014b1d48@6097fca9] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Csrf, OidcLogoutEndpoint, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, OidcProviderConfigurationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint, OidcUserInfoEndpoint, OidcClientRegistrationEndpoint] (1/2)
2025-05-22T13:06:01.006+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'securityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [any request] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Cors, Csrf, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint] (2/2)
2025-05-22T13:06:01.007+05:30 DEBUG 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /sse
2025-05-22T13:06:01.007+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/23)
2025-05-22T13:06:01.007+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/23)
2025-05-22T13:06:01.007+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/23)
2025-05-22T13:06:01.007+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Invoking AuthorizationServerContextFilter (4/23)
2025-05-22T13:06:01.007+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (5/23)
2025-05-22T13:06:01.007+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Invoking CorsFilter (6/23)
2025-05-22T13:06:01.008+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Invoking CsrfFilter (7/23)
2025-05-22T13:06:01.008+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.csrf.CsrfFilter         : Did not protect against CSRF since request did not match And [CsrfNotRequired [TRACE, HEAD, GET, OPTIONS], Not [Or [Or [Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]], Ant [pattern='/.well-known/oauth-authorization-server', GET], Or [Ant [pattern='/oauth2/authorize', GET], Ant [pattern='/oauth2/authorize', POST]], Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST], Or [Ant [pattern='/oauth2/device_verification', GET], Ant [pattern='/oauth2/device_verification', POST]], Ant [pattern='/oauth2/jwks', GET]], org.springframework.security.config.annotation.web.configurers.oauth2.server.resource.OAuth2ResourceServerConfigurer$BearerTokenRequestMatcher@1e5eb20a]]]
2025-05-22T13:06:01.008+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (8/23)
2025-05-22T13:06:01.008+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Ant [pattern='/logout', POST]
2025-05-22T13:06:01.008+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationServerMetadataEndpointFilter (9/23)
2025-05-22T13:06:01.008+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationEndpointFilter (10/23)
2025-05-22T13:06:01.008+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceVerificationEndpointFilter (11/23)
2025-05-22T13:06:01.009+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Invoking NimbusJwkSetEndpointFilter (12/23)
2025-05-22T13:06:01.009+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Invoking OAuth2ClientAuthenticationFilter (13/23)
2025-05-22T13:06:01.009+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.security.web.FilterChainProxy        : Invoking BearerTokenAuthenticationFilter (14/23)
2025-05-22T13:06:01.009+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.s.authentication.ProviderManager     : Authenticating request with JwtAuthenticationProvider (1/18)
2025-05-22T13:06:01.010+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.s.oauth2.jwt.NimbusJwtDecoder        : Failed to process JWT

com.nimbusds.jose.proc.BadJOSEException: Signed JWT rejected: Another algorithm expected, or no matching key(s) found
	at com.nimbusds.jwt.proc.DefaultJWTProcessor.process(DefaultJWTProcessor.java:357) ~[nimbus-jose-jwt-9.37.3.jar:9.37.3]
	at com.nimbusds.jwt.proc.DefaultJWTProcessor.process(DefaultJWTProcessor.java:303) ~[nimbus-jose-jwt-9.37.3.jar:9.37.3]
	at org.springframework.security.oauth2.jwt.NimbusJwtDecoder.createJwt(NimbusJwtDecoder.java:158) ~[spring-security-oauth2-jose-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.jwt.NimbusJwtDecoder.decode(NimbusJwtDecoder.java:138) ~[spring-security-oauth2-jose-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationProvider.getJwt(JwtAuthenticationProvider.java:99) ~[spring-security-oauth2-resource-server-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationProvider.authenticate(JwtAuthenticationProvider.java:88) ~[spring-security-oauth2-resource-server-6.4.5.jar:6.4.5]
	at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:182) ~[spring-security-core-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.resource.web.authentication.BearerTokenAuthenticationFilter.doFilterInternal(BearerTokenAuthenticationFilter.java:137) ~[spring-security-oauth2-resource-server-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2ClientAuthenticationFilter.doFilterInternal(OAuth2ClientAuthenticationFilter.java:129) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.NimbusJwkSetEndpointFilter.doFilterInternal(NimbusJwkSetEndpointFilter.java:88) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2DeviceVerificationEndpointFilter.doFilterInternal(OAuth2DeviceVerificationEndpointFilter.java:152) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2AuthorizationEndpointFilter.doFilterInternal(OAuth2AuthorizationEndpointFilter.java:175) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2AuthorizationServerMetadataEndpointFilter.doFilterInternal(OAuth2AuthorizationServerMetadataEndpointFilter.java:90) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.csrf.CsrfFilter.doFilterInternal(CsrfFilter.java:117) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.AuthorizationServerContextFilter.doFilterInternal(AuthorizationServerContextFilter.java:69) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243) ~[spring-webmvc-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238) ~[spring-security-config-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]

2025-05-22T13:06:01.013+05:30 DEBUG 97469 --- [http-nio-8080-exec-5] o.s.s.o.s.r.a.JwtAuthenticationProvider  : Failed to authenticate since the JWT was invalid
2025-05-22T13:06:01.015+05:30 TRACE 97469 --- [http-nio-8080-exec-5] .s.r.w.a.BearerTokenAuthenticationFilter : Failed to process authentication request

org.springframework.security.oauth2.server.resource.InvalidBearerTokenException: An error occurred while attempting to decode the Jwt: Signed JWT rejected: Another algorithm expected, or no matching key(s) found
	at org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationProvider.getJwt(JwtAuthenticationProvider.java:103) ~[spring-security-oauth2-resource-server-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationProvider.authenticate(JwtAuthenticationProvider.java:88) ~[spring-security-oauth2-resource-server-6.4.5.jar:6.4.5]
	at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:182) ~[spring-security-core-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.resource.web.authentication.BearerTokenAuthenticationFilter.doFilterInternal(BearerTokenAuthenticationFilter.java:137) ~[spring-security-oauth2-resource-server-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2ClientAuthenticationFilter.doFilterInternal(OAuth2ClientAuthenticationFilter.java:129) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.NimbusJwkSetEndpointFilter.doFilterInternal(NimbusJwkSetEndpointFilter.java:88) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2DeviceVerificationEndpointFilter.doFilterInternal(OAuth2DeviceVerificationEndpointFilter.java:152) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2AuthorizationEndpointFilter.doFilterInternal(OAuth2AuthorizationEndpointFilter.java:175) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.web.OAuth2AuthorizationServerMetadataEndpointFilter.doFilterInternal(OAuth2AuthorizationServerMetadataEndpointFilter.java:90) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.csrf.CsrfFilter.doFilterInternal(CsrfFilter.java:117) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.AuthorizationServerContextFilter.doFilterInternal(AuthorizationServerContextFilter.java:69) ~[spring-security-oauth2-authorization-server-1.4.3.jar:1.4.3]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191) ~[spring-security-web-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243) ~[spring-webmvc-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238) ~[spring-security-config-6.4.5.jar:6.4.5]
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
	at java.base/java.lang.Thread.run(Thread.java:840) ~[na:na]
Caused by: org.springframework.security.oauth2.jwt.BadJwtException: An error occurred while attempting to decode the Jwt: Signed JWT rejected: Another algorithm expected, or no matching key(s) found
	at org.springframework.security.oauth2.jwt.NimbusJwtDecoder.createJwt(NimbusJwtDecoder.java:184) ~[spring-security-oauth2-jose-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.jwt.NimbusJwtDecoder.decode(NimbusJwtDecoder.java:138) ~[spring-security-oauth2-jose-6.4.5.jar:6.4.5]
	at org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationProvider.getJwt(JwtAuthenticationProvider.java:99) ~[spring-security-oauth2-resource-server-6.4.5.jar:6.4.5]
	... 84 common frames omitted
Caused by: com.nimbusds.jose.proc.BadJOSEException: Signed JWT rejected: Another algorithm expected, or no matching key(s) found
	at com.nimbusds.jwt.proc.DefaultJWTProcessor.process(DefaultJWTProcessor.java:357) ~[nimbus-jose-jwt-9.37.3.jar:9.37.3]
	at com.nimbusds.jwt.proc.DefaultJWTProcessor.process(DefaultJWTProcessor.java:303) ~[nimbus-jose-jwt-9.37.3.jar:9.37.3]
	at org.springframework.security.oauth2.jwt.NimbusJwtDecoder.createJwt(NimbusJwtDecoder.java:158) ~[spring-security-oauth2-jose-6.4.5.jar:6.4.5]
	... 86 common frames omitted

2025-05-22T13:06:01.017+05:30 TRACE 97469 --- [http-nio-8080-exec-5] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]
2025-05-22T13:06:01.033+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'authorizationServerSecurityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.OAuth2AuthorizationServerConfigurer$$Lambda$995/0x000000c8014b1d48@6097fca9] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Csrf, OidcLogoutEndpoint, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, OidcProviderConfigurationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint, OidcUserInfoEndpoint, OidcClientRegistrationEndpoint] (1/2)
2025-05-22T13:06:01.034+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'securityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [any request] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Cors, Csrf, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint] (2/2)
2025-05-22T13:06:01.034+05:30 DEBUG 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Securing OPTIONS /.well-known/oauth-authorization-server
2025-05-22T13:06:01.034+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/23)
2025-05-22T13:06:01.034+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/23)
2025-05-22T13:06:01.034+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/23)
2025-05-22T13:06:01.034+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking AuthorizationServerContextFilter (4/23)
2025-05-22T13:06:01.035+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (5/23)
2025-05-22T13:06:01.035+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.security.web.FilterChainProxy        : Invoking CorsFilter (6/23)
2025-05-22T13:06:01.035+05:30 TRACE 97469 --- [http-nio-8080-exec-6] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]
2025-05-22T13:06:01.040+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'authorizationServerSecurityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.OAuth2AuthorizationServerConfigurer$$Lambda$995/0x000000c8014b1d48@6097fca9] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Csrf, OidcLogoutEndpoint, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, OidcProviderConfigurationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint, OidcUserInfoEndpoint, OidcClientRegistrationEndpoint] (1/2)
2025-05-22T13:06:01.040+05:30 DEBUG 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /.well-known/oauth-authorization-server
2025-05-22T13:06:01.040+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/26)
2025-05-22T13:06:01.040+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/26)
2025-05-22T13:06:01.040+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/26)
2025-05-22T13:06:01.040+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking AuthorizationServerContextFilter (4/26)
2025-05-22T13:06:01.041+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (5/26)
2025-05-22T13:06:01.041+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking CsrfFilter (6/26)
2025-05-22T13:06:01.041+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.csrf.CsrfFilter         : Did not protect against CSRF since request did not match And [CsrfNotRequired [TRACE, HEAD, GET, OPTIONS], Not [Or [Or [Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]], Ant [pattern='/.well-known/oauth-authorization-server', GET], Or [Ant [pattern='/oauth2/authorize', GET], Ant [pattern='/oauth2/authorize', POST]], Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST], Or [Ant [pattern='/oauth2/device_verification', GET], Ant [pattern='/oauth2/device_verification', POST]], Or [Ant [pattern='/.well-known/openid-configuration', GET], Or [Ant [pattern='/connect/logout', GET], Ant [pattern='/connect/logout', POST]], Or [Ant [pattern='/userinfo', GET], Ant [pattern='/userinfo', POST]], Or [Ant [pattern='/connect/register', POST], Ant [pattern='/connect/register', GET]]], Ant [pattern='/oauth2/jwks', GET]], org.springframework.security.config.annotation.web.configurers.oauth2.server.resource.OAuth2ResourceServerConfigurer$BearerTokenRequestMatcher@3c19592c]]]
2025-05-22T13:06:01.041+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking OidcLogoutEndpointFilter (7/26)
2025-05-22T13:06:01.041+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (8/26)
2025-05-22T13:06:01.041+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Ant [pattern='/logout', POST]
2025-05-22T13:06:01.041+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationServerMetadataEndpointFilter (9/26)
2025-05-22T13:06:01.044+05:30 TRACE 97469 --- [http-nio-8080-exec-7] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]
2025-05-22T13:06:04.055+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'authorizationServerSecurityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.OAuth2AuthorizationServerConfigurer$$Lambda$995/0x000000c8014b1d48@6097fca9] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Csrf, OidcLogoutEndpoint, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, OidcProviderConfigurationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint, OidcUserInfoEndpoint, OidcClientRegistrationEndpoint] (1/2)
2025-05-22T13:06:04.056+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'securityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [any request] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Cors, Csrf, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint] (2/2)
2025-05-22T13:06:04.056+05:30 DEBUG 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Securing GET /sse
2025-05-22T13:06:04.057+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/23)
2025-05-22T13:06:04.057+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/23)
2025-05-22T13:06:04.057+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/23)
2025-05-22T13:06:04.057+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking AuthorizationServerContextFilter (4/23)
2025-05-22T13:06:04.057+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (5/23)
2025-05-22T13:06:04.058+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking CorsFilter (6/23)
2025-05-22T13:06:04.058+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking CsrfFilter (7/23)
2025-05-22T13:06:04.058+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.csrf.CsrfFilter         : Did not protect against CSRF since request did not match And [CsrfNotRequired [TRACE, HEAD, GET, OPTIONS], Not [Or [Or [Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]], Ant [pattern='/.well-known/oauth-authorization-server', GET], Or [Ant [pattern='/oauth2/authorize', GET], Ant [pattern='/oauth2/authorize', POST]], Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST], Or [Ant [pattern='/oauth2/device_verification', GET], Ant [pattern='/oauth2/device_verification', POST]], Ant [pattern='/oauth2/jwks', GET]], org.springframework.security.config.annotation.web.configurers.oauth2.server.resource.OAuth2ResourceServerConfigurer$BearerTokenRequestMatcher@1e5eb20a]]]
2025-05-22T13:06:04.058+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (8/23)
2025-05-22T13:06:04.058+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Ant [pattern='/logout', POST]
2025-05-22T13:06:04.058+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationServerMetadataEndpointFilter (9/23)
2025-05-22T13:06:04.058+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationEndpointFilter (10/23)
2025-05-22T13:06:04.058+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceVerificationEndpointFilter (11/23)
2025-05-22T13:06:04.058+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking NimbusJwkSetEndpointFilter (12/23)
2025-05-22T13:06:04.058+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking OAuth2ClientAuthenticationFilter (13/23)
2025-05-22T13:06:04.058+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking BearerTokenAuthenticationFilter (14/23)
2025-05-22T13:06:04.059+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.s.authentication.ProviderManager     : Authenticating request with JwtAuthenticationProvider (1/18)
2025-05-22T13:06:04.061+05:30 TRACE 97469 --- [http-nio-8080-exec-8] s.o.s.r.a.JwtGrantedAuthoritiesConverter : Looking for scopes in claim scope
2025-05-22T13:06:04.061+05:30 DEBUG 97469 --- [http-nio-8080-exec-8] o.s.s.o.s.r.a.JwtAuthenticationProvider  : Authenticated token
2025-05-22T13:06:04.061+05:30 DEBUG 97469 --- [http-nio-8080-exec-8] .s.r.w.a.BearerTokenAuthenticationFilter : Set SecurityContextHolder to JwtAuthenticationToken [Principal=org.springframework.security.oauth2.jwt.Jwt@a924ec2f, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=127.0.0.1, SessionId=null], Granted Authorities=[SCOPE_client.read]]
2025-05-22T13:06:04.061+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking RequestCacheAwareFilter (15/23)
2025-05-22T13:06:04.061+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.s.w.s.HttpSessionRequestCache        : matchingRequestParameterName is required for getMatchingRequest to lookup a value, but not provided
2025-05-22T13:06:04.061+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderAwareRequestFilter (16/23)
2025-05-22T13:06:04.061+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking AnonymousAuthenticationFilter (17/23)
2025-05-22T13:06:04.061+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking ExceptionTranslationFilter (18/23)
2025-05-22T13:06:04.061+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking AuthorizationFilter (19/23)
2025-05-22T13:06:04.061+05:30 TRACE 97469 --- [http-nio-8080-exec-8] estMatcherDelegatingAuthorizationManager : Authorizing GET /sse
2025-05-22T13:06:04.061+05:30 TRACE 97469 --- [http-nio-8080-exec-8] estMatcherDelegatingAuthorizationManager : Checking authorization on GET /sse using org.springframework.security.authorization.AuthenticatedAuthorizationManager@308fbe8a
2025-05-22T13:06:04.061+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.s.w.a.AnonymousAuthenticationFilter  : Did not set SecurityContextHolder since already authenticated JwtAuthenticationToken [Principal=org.springframework.security.oauth2.jwt.Jwt@a924ec2f, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=127.0.0.1, SessionId=null], Granted Authorities=[SCOPE_client.read]]
2025-05-22T13:06:04.061+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenEndpointFilter (20/23)
2025-05-22T13:06:04.061+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenIntrospectionEndpointFilter (21/23)
2025-05-22T13:06:04.061+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenRevocationEndpointFilter (22/23)
2025-05-22T13:06:04.061+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceAuthorizationEndpointFilter (23/23)
2025-05-22T13:06:04.062+05:30 DEBUG 97469 --- [http-nio-8080-exec-8] o.s.security.web.FilterChainProxy        : Secured GET /sse
2025-05-22T13:06:04.079+05:30 TRACE 97469 --- [http-nio-8080-exec-8] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]
2025-05-22T13:06:04.086+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'authorizationServerSecurityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.OAuth2AuthorizationServerConfigurer$$Lambda$995/0x000000c8014b1d48@6097fca9] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Csrf, OidcLogoutEndpoint, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, OidcProviderConfigurationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint, OidcUserInfoEndpoint, OidcClientRegistrationEndpoint] (1/2)
2025-05-22T13:06:04.087+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'securityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [any request] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Cors, Csrf, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint] (2/2)
2025-05-22T13:06:04.087+05:30 DEBUG 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Securing POST /mcp/message?sessionId=fdcc9647-abb9-443c-8984-40aad4963241
2025-05-22T13:06:04.087+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/23)
2025-05-22T13:06:04.087+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/23)
2025-05-22T13:06:04.087+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/23)
2025-05-22T13:06:04.087+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking AuthorizationServerContextFilter (4/23)
2025-05-22T13:06:04.087+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (5/23)
2025-05-22T13:06:04.087+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking CorsFilter (6/23)
2025-05-22T13:06:04.087+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking CsrfFilter (7/23)
2025-05-22T13:06:04.087+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.csrf.CsrfFilter         : Did not protect against CSRF since request did not match And [CsrfNotRequired [TRACE, HEAD, GET, OPTIONS], Not [Or [Or [Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]], Ant [pattern='/.well-known/oauth-authorization-server', GET], Or [Ant [pattern='/oauth2/authorize', GET], Ant [pattern='/oauth2/authorize', POST]], Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST], Or [Ant [pattern='/oauth2/device_verification', GET], Ant [pattern='/oauth2/device_verification', POST]], Ant [pattern='/oauth2/jwks', GET]], org.springframework.security.config.annotation.web.configurers.oauth2.server.resource.OAuth2ResourceServerConfigurer$BearerTokenRequestMatcher@1e5eb20a]]]
2025-05-22T13:06:04.087+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (8/23)
2025-05-22T13:06:04.087+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Ant [pattern='/logout', POST]
2025-05-22T13:06:04.087+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationServerMetadataEndpointFilter (9/23)
2025-05-22T13:06:04.087+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationEndpointFilter (10/23)
2025-05-22T13:06:04.088+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceVerificationEndpointFilter (11/23)
2025-05-22T13:06:04.088+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking NimbusJwkSetEndpointFilter (12/23)
2025-05-22T13:06:04.088+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking OAuth2ClientAuthenticationFilter (13/23)
2025-05-22T13:06:04.088+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking BearerTokenAuthenticationFilter (14/23)
2025-05-22T13:06:04.088+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.s.authentication.ProviderManager     : Authenticating request with JwtAuthenticationProvider (1/18)
2025-05-22T13:06:04.089+05:30 TRACE 97469 --- [http-nio-8080-exec-9] s.o.s.r.a.JwtGrantedAuthoritiesConverter : Looking for scopes in claim scope
2025-05-22T13:06:04.089+05:30 DEBUG 97469 --- [http-nio-8080-exec-9] o.s.s.o.s.r.a.JwtAuthenticationProvider  : Authenticated token
2025-05-22T13:06:04.089+05:30 DEBUG 97469 --- [http-nio-8080-exec-9] .s.r.w.a.BearerTokenAuthenticationFilter : Set SecurityContextHolder to JwtAuthenticationToken [Principal=org.springframework.security.oauth2.jwt.Jwt@a924ec2f, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=127.0.0.1, SessionId=null], Granted Authorities=[SCOPE_client.read]]
2025-05-22T13:06:04.089+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking RequestCacheAwareFilter (15/23)
2025-05-22T13:06:04.089+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.s.w.s.HttpSessionRequestCache        : matchingRequestParameterName is required for getMatchingRequest to lookup a value, but not provided
2025-05-22T13:06:04.089+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderAwareRequestFilter (16/23)
2025-05-22T13:06:04.089+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking AnonymousAuthenticationFilter (17/23)
2025-05-22T13:06:04.089+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking ExceptionTranslationFilter (18/23)
2025-05-22T13:06:04.089+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking AuthorizationFilter (19/23)
2025-05-22T13:06:04.089+05:30 TRACE 97469 --- [http-nio-8080-exec-9] estMatcherDelegatingAuthorizationManager : Authorizing POST /mcp/message?sessionId=fdcc9647-abb9-443c-8984-40aad4963241
2025-05-22T13:06:04.089+05:30 TRACE 97469 --- [http-nio-8080-exec-9] estMatcherDelegatingAuthorizationManager : Checking authorization on POST /mcp/message?sessionId=fdcc9647-abb9-443c-8984-40aad4963241 using org.springframework.security.authorization.AuthenticatedAuthorizationManager@308fbe8a
2025-05-22T13:06:04.089+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.s.w.a.AnonymousAuthenticationFilter  : Did not set SecurityContextHolder since already authenticated JwtAuthenticationToken [Principal=org.springframework.security.oauth2.jwt.Jwt@a924ec2f, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=127.0.0.1, SessionId=null], Granted Authorities=[SCOPE_client.read]]
2025-05-22T13:06:04.089+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenEndpointFilter (20/23)
2025-05-22T13:06:04.089+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenIntrospectionEndpointFilter (21/23)
2025-05-22T13:06:04.089+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenRevocationEndpointFilter (22/23)
2025-05-22T13:06:04.090+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceAuthorizationEndpointFilter (23/23)
2025-05-22T13:06:04.090+05:30 DEBUG 97469 --- [http-nio-8080-exec-9] o.s.security.web.FilterChainProxy        : Secured POST /mcp/message?sessionId=fdcc9647-abb9-443c-8984-40aad4963241
2025-05-22T13:06:04.104+05:30  INFO 97469 --- [http-nio-8080-exec-9] i.m.server.McpAsyncServer                : Client initialize request - Protocol: 2024-11-05, Capabilities: ClientCapabilities[experimental=null, roots=RootCapabilities[listChanged=true], sampling=Sampling[]], Info: Implementation[name=mcp-inspector, version=0.11.0]
2025-05-22T13:06:04.117+05:30 TRACE 97469 --- [http-nio-8080-exec-9] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]
2025-05-22T13:06:04.119+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'authorizationServerSecurityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [org.springframework.security.oauth2.server.authorization.config.annotation.web.configurers.OAuth2AuthorizationServerConfigurer$$Lambda$995/0x000000c8014b1d48@6097fca9] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Csrf, OidcLogoutEndpoint, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, OidcProviderConfigurationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint, OidcUserInfoEndpoint, OidcClientRegistrationEndpoint] (1/2)
2025-05-22T13:06:04.119+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Trying to match request against DefaultSecurityFilterChain defined as 'securityFilterChain' in [class path resource [org/springframework/ai/mcp/sample/server/SecurityConfiguration.class]] matching [any request] and having filters [DisableEncodeUrl, WebAsyncManagerIntegration, SecurityContextHolder, AuthorizationServerContext, HeaderWriter, Cors, Csrf, Logout, OAuth2AuthorizationServerMetadataEndpoint, OAuth2AuthorizationEndpoint, OAuth2DeviceVerificationEndpoint, NimbusJwkSetEndpoint, OAuth2ClientAuthentication, BearerTokenAuthentication, RequestCacheAware, SecurityContextHolderAwareRequest, AnonymousAuthentication, ExceptionTranslation, Authorization, OAuth2TokenEndpoint, OAuth2TokenIntrospectionEndpoint, OAuth2TokenRevocationEndpoint, OAuth2DeviceAuthorizationEndpoint] (2/2)
2025-05-22T13:06:04.119+05:30 DEBUG 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Securing POST /mcp/message?sessionId=fdcc9647-abb9-443c-8984-40aad4963241
2025-05-22T13:06:04.119+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking DisableEncodeUrlFilter (1/23)
2025-05-22T13:06:04.119+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking WebAsyncManagerIntegrationFilter (2/23)
2025-05-22T13:06:04.119+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderFilter (3/23)
2025-05-22T13:06:04.119+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking AuthorizationServerContextFilter (4/23)
2025-05-22T13:06:04.119+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking HeaderWriterFilter (5/23)
2025-05-22T13:06:04.119+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking CorsFilter (6/23)
2025-05-22T13:06:04.119+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking CsrfFilter (7/23)
2025-05-22T13:06:04.119+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.csrf.CsrfFilter         : Did not protect against CSRF since request did not match And [CsrfNotRequired [TRACE, HEAD, GET, OPTIONS], Not [Or [Or [Or [Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST]], Ant [pattern='/.well-known/oauth-authorization-server', GET], Or [Ant [pattern='/oauth2/authorize', GET], Ant [pattern='/oauth2/authorize', POST]], Ant [pattern='/oauth2/token', POST], Ant [pattern='/oauth2/introspect', POST], Ant [pattern='/oauth2/revoke', POST], Ant [pattern='/oauth2/device_authorization', POST], Or [Ant [pattern='/oauth2/device_verification', GET], Ant [pattern='/oauth2/device_verification', POST]], Ant [pattern='/oauth2/jwks', GET]], org.springframework.security.config.annotation.web.configurers.oauth2.server.resource.OAuth2ResourceServerConfigurer$BearerTokenRequestMatcher@1e5eb20a]]]
2025-05-22T13:06:04.119+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking LogoutFilter (8/23)
2025-05-22T13:06:04.119+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.s.w.a.logout.LogoutFilter            : Did not match request to Ant [pattern='/logout', POST]
2025-05-22T13:06:04.120+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationServerMetadataEndpointFilter (9/23)
2025-05-22T13:06:04.120+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking OAuth2AuthorizationEndpointFilter (10/23)
2025-05-22T13:06:04.120+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceVerificationEndpointFilter (11/23)
2025-05-22T13:06:04.120+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking NimbusJwkSetEndpointFilter (12/23)
2025-05-22T13:06:04.120+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking OAuth2ClientAuthenticationFilter (13/23)
2025-05-22T13:06:04.120+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking BearerTokenAuthenticationFilter (14/23)
2025-05-22T13:06:04.120+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.s.authentication.ProviderManager     : Authenticating request with JwtAuthenticationProvider (1/18)
2025-05-22T13:06:04.121+05:30 TRACE 97469 --- [http-nio-8080-exec-10] s.o.s.r.a.JwtGrantedAuthoritiesConverter : Looking for scopes in claim scope
2025-05-22T13:06:04.121+05:30 DEBUG 97469 --- [http-nio-8080-exec-10] o.s.s.o.s.r.a.JwtAuthenticationProvider  : Authenticated token
2025-05-22T13:06:04.121+05:30 DEBUG 97469 --- [http-nio-8080-exec-10] .s.r.w.a.BearerTokenAuthenticationFilter : Set SecurityContextHolder to JwtAuthenticationToken [Principal=org.springframework.security.oauth2.jwt.Jwt@a924ec2f, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=127.0.0.1, SessionId=null], Granted Authorities=[SCOPE_client.read]]
2025-05-22T13:06:04.121+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking RequestCacheAwareFilter (15/23)
2025-05-22T13:06:04.121+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.s.w.s.HttpSessionRequestCache        : matchingRequestParameterName is required for getMatchingRequest to lookup a value, but not provided
2025-05-22T13:06:04.121+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking SecurityContextHolderAwareRequestFilter (16/23)
2025-05-22T13:06:04.121+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking AnonymousAuthenticationFilter (17/23)
2025-05-22T13:06:04.121+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking ExceptionTranslationFilter (18/23)
2025-05-22T13:06:04.121+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking AuthorizationFilter (19/23)
2025-05-22T13:06:04.121+05:30 TRACE 97469 --- [http-nio-8080-exec-10] estMatcherDelegatingAuthorizationManager : Authorizing POST /mcp/message?sessionId=fdcc9647-abb9-443c-8984-40aad4963241
2025-05-22T13:06:04.121+05:30 TRACE 97469 --- [http-nio-8080-exec-10] estMatcherDelegatingAuthorizationManager : Checking authorization on POST /mcp/message?sessionId=fdcc9647-abb9-443c-8984-40aad4963241 using org.springframework.security.authorization.AuthenticatedAuthorizationManager@308fbe8a
2025-05-22T13:06:04.121+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.s.w.a.AnonymousAuthenticationFilter  : Did not set SecurityContextHolder since already authenticated JwtAuthenticationToken [Principal=org.springframework.security.oauth2.jwt.Jwt@a924ec2f, Credentials=[PROTECTED], Authenticated=true, Details=WebAuthenticationDetails [RemoteIpAddress=127.0.0.1, SessionId=null], Granted Authorities=[SCOPE_client.read]]
2025-05-22T13:06:04.121+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenEndpointFilter (20/23)
2025-05-22T13:06:04.121+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenIntrospectionEndpointFilter (21/23)
2025-05-22T13:06:04.121+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking OAuth2TokenRevocationEndpointFilter (22/23)
2025-05-22T13:06:04.121+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Invoking OAuth2DeviceAuthorizationEndpointFilter (23/23)
2025-05-22T13:06:04.121+05:30 DEBUG 97469 --- [http-nio-8080-exec-10] o.s.security.web.FilterChainProxy        : Secured POST /mcp/message?sessionId=fdcc9647-abb9-443c-8984-40aad4963241
2025-05-22T13:06:04.123+05:30 TRACE 97469 --- [http-nio-8080-exec-10] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match request to [Is Secure]
